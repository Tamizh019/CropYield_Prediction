============================================================
ğŸŒ¾ AGRIVISION MODEL TRAINING PIPELINE
â° Started: 2026-01-08 23:18:39
============================================================

============================================================
ğŸŒ¾ TRAINING YIELD PREDICTION MODEL (ADVANCED)
============================================================
âœ… Dataset loaded: 50765 rows
ğŸ“Š Columns: ['Dist Code', 'Year', 'State Code', 'State Name', 'Dist Name', 'Crop', 'Area_ha', 'Yield_kg_per_ha', 'N_req_kg_per_ha', 'P_req_kg_per_ha', 'K_req_kg_per_ha', 'Total_N_kg', 'Total_P_kg', 'Total_K_kg', 'Temperature_C', 'Humidity_%', 'pH', 'Rainfall_mm', 'Wind_Speed_m_s', 'Solar_Radiation_MJ_m2_day']
ğŸ¯ Target Column: Yield_kg_per_ha
ğŸ§¹ Cleaned data: 50765 rows (removed 0)
âœ… Features selected: ['State_Name', 'District_Name', 'Crop_Year', 'Crop', 'Area', 'Temperature', 'Humidity', 'pH', 'Rainfall']

ğŸ”§ Feature Engineering...
âœ… Total features after engineering: 13
ğŸ”¤ Encoding 3 categorical columns...
   - State_Name: 20 unique values
   - District_Name: 311 unique values
   - Crop: 4 unique values
ğŸ’¾ Label encoders saved
ğŸ’¾ Scaler saved

ğŸ“Š Training set: 40612 | Test set: 10153

ğŸ¤– Training Multiple Models...

1ï¸âƒ£ Random Forest Regressor...
   RÂ² Score: 0.8635
   RMSE: 355.24
   MAE: 203.82

2ï¸âƒ£ Gradient Boosting Regressor...
   RÂ² Score: 0.8319
   RMSE: 394.22
   MAE: 233.54

3ï¸âƒ£ XGBoost Regressor...
   RÂ² Score: 0.8504
   RMSE: 371.90
   MAE: 223.11

============================================================
ğŸ“Š MODEL COMPARISON
============================================================
RandomForest         | RÂ²: 0.8635 | RMSE:   355.24 | MAE:   203.82
GradientBoosting     | RÂ²: 0.8319 | RMSE:   394.22 | MAE:   233.54
XGBoost              | RÂ²: 0.8504 | RMSE:   371.90 | MAE:   223.11

ğŸ† BEST MODEL: RandomForest (RÂ² = 0.8635)

âœ… Yield Model Training Complete!
ğŸ’¾ Models saved in 'models/' directory

============================================================
ğŸŒ¾ TRAINING CROP RECOMMENDATION MODEL (ADVANCED)
============================================================
âœ… Dataset loaded: 2200 rows
ğŸ“Š Columns: ['N', 'P', 'K', 'temperature', 'humidity', 'ph', 'rainfall', 'label']
ğŸ¯ Target classes: 22 unique crops
ğŸ“Š Class distribution:
label
rice          100
maize         100
jute          100
cotton        100
coconut       100
papaya        100
orange        100
apple         100
muskmelon     100
watermelon    100
Name: count, dtype: int64

ğŸ”§ Feature Engineering...
   âœ… NPK ratio features created
   âœ… Temperature-Humidity interaction created
   âœ… Rainfall-pH interaction created
ğŸ’¾ Scaler saved

ğŸ“Š Training set: 1760 | Test set: 440

ğŸ¤– Training Multiple Models...

1ï¸âƒ£ Random Forest Classifier...
   Accuracy: 0.9909

2ï¸âƒ£ Gradient Boosting Classifier...
   Accuracy: 0.9864

3ï¸âƒ£ XGBoost Classifier...

âŒ TRAINING FAILED: Invalid classes inferred from unique values of `y`.  Expected: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21], got ['apple' 'banana' 'blackgram' 'chickpea' 'coconut' 'coffee' 'cotton'
 'grapes' 'jute' 'kidneybeans' 'lentil' 'maize' 'mango' 'mothbeans'
 'mungbean' 'muskmelon' 'orange' 'papaya' 'pigeonpeas' 'pomegranate'
 'rice' 'watermelon']
Traceback (most recent call last):
  File "C:\Users\jefft\OneDrive\Desktop\CropYield_Prediction\train_models.py", line 491, in <module>
    train_recommendation_model()
  File "C:\Users\jefft\OneDrive\Desktop\CropYield_Prediction\train_models.py", line 426, in train_recommendation_model
    xgb_model.fit(X_train, y_train)
  File "C:\Users\jefft\AppData\Local\Programs\Python\Python312\Lib\site-packages\xgboost\core.py", line 730, in inner_f
    return func(**kwargs)
           ^^^^^^^^^^^^^^
  File "C:\Users\jefft\AppData\Local\Programs\Python\Python312\Lib\site-packages\xgboost\sklearn.py", line 1471, in fit
    raise ValueError(
ValueError: Invalid classes inferred from unique values of `y`.  Expected: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21], got ['apple' 'banana' 'blackgram' 'chickpea' 'coconut' 'coffee' 'cotton'
 'grapes' 'jute' 'kidneybeans' 'lentil' 'maize' 'mango' 'mothbeans'
 'mungbean' 'muskmelon' 'orange' 'papaya' 'pigeonpeas' 'pomegranate'
 'rice' 'watermelon']

